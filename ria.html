
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RIA - Regulatory Impact Analyzer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
 
    /* Header */
    .header {
      background: #3e9ca8;
      color: white;
      padding: 20px;
      border-radius: 0;
      position: relative;
      text-align: center;
    }
    .header img {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      height: 150px;
      width: auto;
      object-fit: contain;
      left: 0%;
    }
    
    .user-section {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.15);
      padding: 12px 16px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }
    
    .user-section:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-50%) scale(1.02);
    }
    
    .user-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #3e9ca8;
      font-size: 1.2em;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    
    .user-info {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    
    .user-role {
      font-size: 0.85em;
      font-weight: 600;
      margin: 0;
      opacity: 0.9;
    }
    
    .user-status {
      font-size: 0.7em;
      margin: 2px 0 0 0;
      opacity: 0.7;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #22c55e;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Header Action Buttons */
    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: 12px;
    }
    
    .action-btn {
      width: 32px;
      height: 32px;
      border: none;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      position: relative;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .action-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    
    .action-btn i {
      font-size: 0.9em;
    }
    
    .notification-badge {
      position: absolute;
      top: -2px;
      right: -2px;
      background: #ef4444;
      color: white;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      font-size: 0.7em;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      border: 2px solid #3e9ca8;
    }
    
    .settings-btn:hover i {
      animation: rotate 0.5s ease-in-out;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(180deg); }
    }
 
    /* Layout wrapper */
    .content-wrapper {
      display: flex;
      flex: 1;
    }
 
    /* Sidebar */
    .sidebar {
      width: 110px;
      background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }
    .sidebar a {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      color: rgba(255, 255, 255, 0.9);
      text-decoration: none;
      margin-bottom: 8px;
      border-radius: 10px;
      width: calc(100% - 30px);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: 0.3px;
      backdrop-filter: blur(5px);
    }
    .sidebar a:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(5px);
      border-color: rgba(255, 255, 255, 0.3);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    .sidebar a.active {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.4);
      color: white;
      font-weight: 700;
    }
    .sidebar a i {
      margin-right: 12px;
      font-size: 16px;
      width: 20px;
      text-align: center;
    }

    /* Quick Stats Styles */
    .quick-stats {
      width: 100%;
      margin-top: 20px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 12px 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
    }

    .stats-header {
      text-align: center;
      margin-bottom: 14px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .stats-header h4 {
      margin: 0;
      font-size: 12px;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.9);
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    .stats-header i {
      display: block;
      font-size: 16px;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 4px;
    }

    .stat-item {
      margin-bottom: 8px;
      padding: 8px 6px;
      text-align: center;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .stat-item:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .stat-item:last-child {
      margin-bottom: 0;
    }

    .stat-label {
      font-size: 10px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 3px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    .stat-value {
      font-size: 18px;
      font-weight: 800;
      color: white;
      margin-bottom: 3px;
      line-height: 1;
    }

    .stat-change {
      font-size: 9px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 3px;
    }

    .stat-change.positive {
      color: #4ade80;
    }

    .stat-change.negative {
      color: #f87171;
    }

    .stat-change i {
      font-size: 8px;
    }
 
    /* Main Content */
    .main {
      flex: 1;
      background: #f3f4f6;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    /* RIA Header */
    .ria-header {
      background: linear-gradient(135deg, #3e9ca8 0%, #2c7a86 50%, #1f5d68 100%);
      color: white;
      padding: 20px 25px;
      border-radius: 12px;
      margin-bottom: 20px;
      position: relative;
      box-shadow: 0 6px 24px rgba(62, 156, 168, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(8px);
      overflow: hidden;
    }

    .ria-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
      pointer-events: none;
    }

    .ria-header h1 {
      margin: 0;
      font-size: 1.9em;
      font-weight: 600;
      letter-spacing: -0.3px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .ria-header h1::before {
      content: '\f544';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      font-size: 0.75em;
      background: linear-gradient(135deg, #ffffff 0%, #e2f3f5 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.15));
    }

    .ria-header p {
      margin: 8px 0 0 0;
      font-size: 0.95em;
      opacity: 0.92;
      font-weight: 400;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
      letter-spacing: 0.2px;
    }

    /* Filters Section */
    .filters-section {
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .filters-section h3 {
      margin: 0 0 15px 0;
      font-size: 1.1em;
      color: #333;
    }

    .filters-row {
      display: flex;
      gap: 15px;
      align-items: flex-end;
      flex-wrap: wrap;
      width: 100%;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-width: 0;
    }

    .filter-group label {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .filter-group select {
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9em;
      background: white;
      cursor: pointer;
      height: 42px;
      width: 100%;
    }

    .filter-group select:focus {
      outline: none;
      border-color: #3e9ca8;
      box-shadow: 0 0 0 2px rgba(62, 156, 168, 0.2);
    }

    /* News Feed Form Styles */
    .news-feed-form {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      border: 1px solid #dee2e6;
    }

    .news-feed-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e9ecef;
    }

    .news-feed-header h3 {
      color: #2c3e50;
      font-size: 20px;
      font-weight: 700;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .news-feed-header h3 i {
      color: #3498db;
      font-size: 22px;
    }

    .document-count-badge {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 3px 10px rgba(52, 152, 219, 0.3);
    }

    .news-content-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      border: 1px solid #e9ecef;
    }

    .news-title-section {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #f1f3f4;
    }

    .expand-toggle {
      width: 30px;
      height: 30px;
      background: #28a745;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .expand-toggle:hover {
      transform: scale(1.05);
      background: #218838;
    }

    .expand-toggle i {
      color: white;
      font-size: 14px;
    }

    .news-title {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .title-text {
      font-size: 18px;
      font-weight: 600;
      color: #2c3e50;
    }

    .update-status {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .update-status.new {
      background: #dc3545;
      color: white;
    }

    .news-details-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .detail-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .detail-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .detail-item label {
      font-size: 11px;
      font-weight: 600;
      color: #6c757d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .detail-item label i {
      color: #6c757d;
      font-size: 12px;
    }

    .detail-value {
      font-size: 14px;
      font-weight: 500;
      color: #495057;
      padding: 10px 12px;
      background: #f8f9fa;
      border-radius: 6px;
      border: 1px solid #e9ecef;
    }

    .agency-badge {
      background: #007bff;
      color: white;
      text-align: center;
      border: 1px solid #007bff;
      font-weight: 600;
    }

    .countdown {
      background: #fd7e14;
      color: white;
      border: 1px solid #fd7e14;
      text-align: center;
      font-weight: 600;
    }

    .summary-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #f1f3f4;
    }

    .summary-section label {
      font-size: 11px;
      font-weight: 600;
      color: #6c757d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 10px;
    }

    .summary-section label i {
      color: #6c757d;
      font-size: 12px;
    }

    .summary-content {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      font-size: 14px;
      line-height: 1.6;
      color: #495057;
      border-left: 3px solid #28a745;
      border: 1px solid #e9ecef;
    }

    /* Enhanced Summary Section Styles */
    .enhanced-summary-section {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    .summary-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      position: relative;
    }

    .summary-icon {
      width: 45px;
      height: 45px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 18px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .summary-header h4 {
      color: white;
      font-size: 18px;
      font-weight: 600;
      margin: 0;
      flex-grow: 1;
    }

    .summary-badge {
      background: rgba(255, 255, 255, 0.15);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      animation: pulse 2s infinite;
    }

    .summary-content-enhanced {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      padding: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .summary-highlight {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
      color: #e74c3c;
      font-weight: 600;
      font-size: 14px;
    }

    .summary-highlight i {
      font-size: 16px;
    }

    .summary-text {
      color: #2c3e50;
      font-size: 15px;
      line-height: 1.6;
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .summary-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .summary-btn {
      padding: 10px 18px;
      border-radius: 8px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .summary-btn.primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .summary-btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .summary-btn.secondary {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .summary-btn.secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    .summary-btn.tertiary {
      background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
    }

    .summary-btn.tertiary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.3);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
      }
    }

    .additional-news {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
      border: 1px solid #e3e6ea;
    }

    .additional-news-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f1f3f4;
    }

    .additional-news-header h4 {
      color: #2c3e50;
      font-size: 16px;
      font-weight: 700;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .additional-news-header h4 i {
      color: #3498db;
      font-size: 18px;
    }

    .news-count {
      background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }

    .news-item {
      background: #f8f9fa;
      border-radius: 10px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid #e9ecef;
      overflow: hidden;
    }

    .news-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      border-color: #3498db;
    }

    .news-item.expanded {
      background: white;
      border: 2px solid #3498db;
      box-shadow: 0 6px 20px rgba(52, 152, 219, 0.2);
      position: relative;
    }

    .news-item-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 15px 20px 0;
      gap: 10px;
    }

    .news-badges-left {
      display: flex;
      align-items: center;
    }

    .news-badges-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
    }

    .news-badge {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .news-badge.recent {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      animation: pulse 2s infinite;
    }

    .news-priority {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      white-space: nowrap;
    }

    .news-priority.high {
      background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
      color: white;
    }

    .new-badge {
      background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
      color: white;
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 9px;
      font-weight: 700;
      text-transform: uppercase;
      animation: pulse 2s infinite;
      white-space: nowrap;
    }

    .news-content {
      padding: 15px 20px;
    }

    .news-title {
      font-size: 16px;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .news-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 12px;
      font-size: 12px;
      color: #6c757d;
    }

    .news-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .news-meta i {
      color: #3498db;
    }

    .news-preview {
      font-size: 13px;
      color: #495057;
      line-height: 1.5;
      margin-top: 10px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 6px;
      border-left: 3px solid #3498db;
    }

    .news-actions {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #f1f3f4;
      display: flex;
      justify-content: flex-end;
    }

    .impact-analyze-btn {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
    }

    .impact-analyze-btn:hover {
      background: linear-gradient(135deg, #2980b9 0%, #21618c 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
    }

    .impact-analyze-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
    }

    .impact-analyze-btn i {
      font-size: 11px;
    }

    /* Adjust news actions for collapsed items */
    .news-item.collapsed .news-actions {
      margin-top: 10px;
      padding-top: 10px;
    }

    .news-item.collapsed .impact-analyze-btn {
      padding: 6px 12px;
      font-size: 11px;
    }

    /* View Full Details Button */
    .view-full-btn {
      background: #3e9ca8;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: 8px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .view-full-btn:hover {
      background: #2c7a84;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .view-full-btn:active {
      transform: translateY(0);
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .view-full-btn i {
      font-size: 10px;
    }

    .news-item.collapsed {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
    }

    .news-item.collapsed .news-content {
      padding: 12px 20px;
    }

    /* Impacted Documents Badges Styles */
    .news-content {
      padding: 15px 20px;
    }

    .news-content-main {
      width: 100%;
    }

    .news-bottom-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-top: 15px;
    }

    .news-actions {
      display: flex;
      align-items: center;
    }

    .impacted-documents-badges {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: flex-end;
      align-self: flex-start;
    }

    .document-count-badge {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
      white-space: nowrap;
    }

    .document-count-badge i {
      font-size: 10px;
    }

    .new-badge {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 6px rgba(40, 167, 69, 0.3);
      animation: pulse-new 2s infinite;
    }

    @keyframes pulse-new {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .impacted-documents-sidebar h4 {
      margin: 0 0 15px 0;
      font-size: 14px;
      font-weight: 700;
      color: #495057;
      display: flex;
      align-items: center;
      gap: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .impacted-documents-sidebar h4 i {
      color: #007bff;
      font-size: 12px;
    }

    .impacted-documents-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .impacted-doc-btn {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 10px 12px;
      color: #495057;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      text-align: left;
      width: 100%;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .impacted-doc-btn:hover {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      color: white;
      transform: translateY(-1px);
      box-shadow: 0 3px 8px rgba(0, 123, 255, 0.3);
      border-color: #007bff;
    }

    .impacted-doc-btn i {
      font-size: 11px;
      min-width: 12px;
    }

    .impacted-doc-btn span {
      line-height: 1.3;
    }

    .news-item.collapsed .news-title {
      font-size: 14px;
      margin-bottom: 8px;
    }

    .collapsible-section {
      margin-top: 20px;
    }

    .collapse-header {
      background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .collapse-header:hover {
      background: linear-gradient(135deg, #495057 0%, #343a40 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .collapse-header span {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .collapse-icon {
      transition: transform 0.3s ease;
    }

    .collapse-header.active .collapse-icon {
      transform: rotate(180deg);
    }

    .collapsed-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .collapsed-content.show {
      max-height: 500px;
      padding-top: 15px;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    @media (max-width: 768px) {
      .news-details-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .news-feed-header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
      
      .news-meta {
        flex-direction: column;
        gap: 8px;
      }
    }

    /* Analysis Section Enhancements */
    .no-analysis-message {
      text-align: center;
      color: #6c757d;
      font-style: italic;
      padding: 40px 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border: 2px dashed #dee2e6;
    }

    .analysis-loading {
      text-align: center;
      color: #3e9ca8;
      padding: 40px 20px;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f7fa 100%);
      border-radius: 8px;
      border: 2px solid #3e9ca8;
      animation: pulse-border 2s infinite;
    }

    @keyframes pulse-border {
      0%, 100% { border-color: #3e9ca8; }
      50% { border-color: #22c55e; }
    }

    .analysis-active {
      border: 2px solid #22c55e;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
    }

    .data-item {
      background: white;
      border: 1px solid #e9ecef;
      border-radius: 6px;
      padding: 15px;
      margin-bottom: 10px;
      transition: all 0.3s ease;
      position: relative;
      border-left: 4px solid #3e9ca8;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .data-item:hover {
      border-left-color: #22c55e;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transform: translateX(3px);
    }

    .data-item .section-title {
      font-weight: 600;
      color: #3e9ca8;
      font-size: 0.9em;
      margin-bottom: 5px;
      display: block;
    }

    .data-item .section-content {
      color: #4a5568;
      line-height: 1.4;
      font-size: 0.85em;
    }

    .comparison-item {
      background: white;
      border-left: 4px solid #3e9ca8;
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 0 6px 6px 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }

    .comparison-item:hover {
      border-left-color: #22c55e;
      transform: translateX(5px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .analysis-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .analysis-status {
      background: #22c55e;
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.8em;
      font-weight: 600;
    }

    .news-badge {
      background: #ef4444;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.75em;
      font-weight: 600;
      min-width: 35px;
      text-align: center;
    }

    .news-content {
      flex: 1;
    }

    .news-title {
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 6px;
      line-height: 1.3;
    }

    .news-meta {
      display: flex;
      gap: 15px;
      font-size: 0.8em;
      color: #6b7280;
    }

    .news-agency {
      font-weight: 600;
      color: #3e9ca8;
    }

    .time-left {
      color: #dc2626;
      font-weight: 500;
    }

    .form-group textarea {
      height: 80px;
      resize: vertical;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 10px;
    }

    .save-btn-form {
      background: #22c55e;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }

    /* Content Grid */
    .content-grid {
      display: flex;
      gap: 20px;
      flex: 1;
    }

    .left-column {
      flex: 1;
    }

    /* News Feed */
    .news-feed {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .news-feed h3 {
      margin: 0 0 15px 0;
      color: #333;
      border-bottom: 2px solid #3e9ca8;
      padding-bottom: 10px;
    }

    .news-feed-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f8f9fa;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
      font-weight: bold;
      font-size: 0.9em;
    }

    .news-entry {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 10px;
      border-bottom: 1px solid #eee;
      font-size: 0.9em;
    }

    .news-entry:last-child {
      border-bottom: none;
    }

    /* Impact Section */
    .impact-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .impact-section h3 {
      margin: 0 0 15px 0;
      color: #333;
      border-bottom: 2px solid #3e9ca8;
      padding-bottom: 10px;
    }

    .impact-table {
      width: 100%;
      border-collapse: collapse;
    }

    .impact-table th {
      background: #f8f9fa;
      padding: 10px 8px;
      text-align: center;
      font-size: 0.8em;
      border: 1px solid #ddd;
      font-weight: bold;
    }

    .impact-table td {
      padding: 15px 8px;
      text-align: center;
      border: 1px solid #ddd;
      font-size: 0.8em;
    }

    .impact-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 4px 8px;
      border-radius: 3px;
      font-size: 0.8em;
      cursor: pointer;
      margin: 1px;
    }

    .analyse-btn {
      background: #22c55e;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 0.9em;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .analyse-btn:hover:not(.disabled) {
      background: #16a34a;
      transform: scale(1.05);
    }

    .analyse-btn.disabled {
      background: #9ca3af;
      color: #6b7280;
      cursor: not-allowed;
      opacity: 0.6;
    }

    .analyse-btn.disabled:hover {
      background: #9ca3af;
      transform: none;
    }

    .analyse-btn:not(.disabled) {
      animation: pulse-ready 2s infinite;
    }

    @keyframes pulse-ready {
      0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
      50% { box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.1); }
    }

    /* Analysis Section */
    .analysis-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .analysis-section h3 {
      margin: 0 0 15px 0;
      color: #333;
      border-bottom: 2px solid #3e9ca8;
      padding-bottom: 10px;
    }

    .analysis-grid {
      display: flex;
      gap: 20px;
    }

    .analysis-grid-three {
      display: flex;
      gap: 15px;
      align-items: stretch;
      min-height: 400px;
    }

    .analysis-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }

    .analysis-column h4 {
      background: #e3f2fd;
      padding: 10px;
      margin: 0 0 10px 0;
      border-radius: 4px;
      font-size: 0.9em;
      color: #1976d2;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .analysis-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .analysis-list li {
      padding: 5px 0;
      font-size: 0.85em;
      border-bottom: 1px solid #eee;
    }

    .analysis-list li:last-child {
      border-bottom: none;
    }

    .impacted-data-display,
    .llm-comparison-display,
    .generated-document-display {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 6px;
      padding: 15px;
      height: 300px;
      overflow-y: auto;
      flex: 1;
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
    }

    .generated-document-display {
      min-height: 300px;
    }

    .no-document-message {
      text-align: center;
      color: #6c757d;
      font-style: italic;
      font-size: 0.9em;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      padding: 20px;
    }

    .generated-content {
      font-size: 0.8em;
      line-height: 1.4;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
    }

    .download-document-btn {
      background: #22c55e;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 500;
      margin-top: 10px;
      width: 100%;
      transition: background-color 0.2s ease;
    }

    .download-document-btn:hover {
      background: #16a34a;
    }

    .download-document-btn i {
      margin-right: 8px;
    }

    /* Download Comparison Button */
    .download-comparison-btn {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 600;
      margin-top: 15px;
      width: 100%;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .download-comparison-btn:hover {
      background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }

    .download-comparison-btn i {
      margin-right: 8px;
    }

    /* AI Chat Container Styles */
    .ai-chat-container {
      display: flex;
      flex-direction: column;
      height: 300px;
      background: #f8fafc;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
      flex: 1;
    }

    .chat-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    }

    .initial-chat-message {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 15px;
      background: white;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border-left: 4px solid #3b82f6;
    }

    .initial-chat-message i {
      color: #3b82f6;
      font-size: 1.2em;
      margin-top: 2px;
    }

    .initial-chat-message p {
      margin: 0;
      color: #374151;
      line-height: 1.5;
      font-size: 0.9em;
    }

    .chat-message {
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .user-message {
      align-self: flex-end;
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white;
      padding: 12px 16px;
      border-radius: 18px 18px 4px 18px;
      max-width: 80%;
      font-size: 0.9em;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .ai-message {
      align-self: flex-start;
      background: white;
      color: #374151;
      padding: 12px 16px;
      border-radius: 18px 18px 18px 4px;
      max-width: 85%;
      font-size: 0.9em;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border-left: 3px solid #10b981;
    }

    .chat-input-section {
      padding: 15px;
      background: white;
      border-top: 1px solid #e5e7eb;
      display: flex;
      gap: 10px;
      align-items: flex-end;
      margin-top: auto;
    }

    .chat-input-box {
      flex: 1;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      resize: vertical;
      font-family: Arial, sans-serif;
      font-size: 0.9em;
      transition: border-color 0.3s ease;
    }

    .chat-input-box:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .send-chat-btn {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    .send-chat-btn:hover {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }

    .send-chat-btn i {
      margin-right: 6px;
    }

    /* Key Changes Section Styles */
    .key-changes-section {
      margin-top: 20px;
      width: 100%;
    }

    .key-changes-card {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
    }

    .key-changes-card:hover {
      border-color: #f59e0b;
      box-shadow: 0 6px 25px rgba(245, 158, 11, 0.15);
    }

    .key-changes-card h4 {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
      padding: 20px;
      margin: 0;
      font-size: 1.1em;
      font-weight: 600;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .key-changes-card h4::before {
      content: "\f0c5";
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
    }

    .key-changes-display {
      background: #fefbf3;
      border: 1px solid #fde68a;
      border-radius: 0 0 8px 8px;
      padding: 25px;
      min-height: 200px;
      display: flex;
      flex-direction: column;
    }

    .no-changes-message {
      text-align: center;
      color: #92400e;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 15px;
    }

    .no-changes-message i {
      font-size: 2.5em;
      opacity: 0.6;
    }

    .no-changes-message p {
      margin: 0;
      font-size: 1em;
      line-height: 1.5;
      max-width: 400px;
    }

    .key-changes-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .key-change-item {
      background: white;
      border: 1px solid #fed7aa;
      border-radius: 8px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .key-change-item:hover {
      border-color: #f59e0b;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
      transform: translateY(-2px);
    }

    .key-change-title {
      font-weight: 600;
      color: #92400e;
      margin-bottom: 10px;
      font-size: 1em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .key-change-description {
      color: #451a03;
      font-size: 0.9em;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .key-change-impact {
      background: #fed7aa;
      color: #92400e;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.8em;
      font-weight: 600;
      display: inline-block;
    }

    .data-item,
    .comparison-item {
      padding: 8px 0;
      border-bottom: 1px solid #dee2e6;
      font-size: 0.85em;
      line-height: 1.4;
    }

    .data-item:last-child,
    .comparison-item:last-child {
      border-bottom: none;
    }

    .comparison-item strong {
      color: #2563eb;
    }

    .generated-result {
      margin-top: 25px;
      padding: 20px;
      background: #f0f9ff;
      border: 1px solid #bae6fd;
      border-radius: 8px;
    }

    .generated-result h4 {
      margin: 0 0 15px 0;
      color: #1e40af;
    }

    .result-content {
      background: white;
      border-radius: 6px;
      padding: 15px;
    }

    .result-text {
      min-height: 200px;
      padding: 15px;
      background: #fafafa;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.85em;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    .result-actions {
      margin-top: 15px;
      text-align: center;
    }

    .download-result-btn {
      background: #22c55e;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95em;
      font-weight: 500;
      transition: background-color 0.2s ease;
    }

    .download-result-btn:hover {
      background: #16a34a;
    }

    .download-result-btn i {
      margin-right: 8px;
    }

    .generate-btn {
      background: #1976d2;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 15px;
      width: 100%;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9em;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .generate-btn:hover {
      background: #1565c0;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(25, 118, 210, 0.3);
    }

    .generate-comparison-btn {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      margin-top: 15px;
      margin-bottom: 10px;
      transition: all 0.3s ease;
      width: 100%;
      font-size: 0.95em;
      box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
      animation: pulse-orange 2s infinite;
    }

    .generate-comparison-btn:hover {
      background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
    }

    @keyframes pulse-orange {
      0%, 100% { box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3); }
      50% { box-shadow: 0 4px 8px rgba(245, 158, 11, 0.6); }
    }

    /* New Data Input Section Styles */
    .new-data-input {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border: 2px solid #3b82f6;
      border-radius: 12px;
      padding: 20px;
      margin: 15px 0;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
    }

    .new-data-input h5 {
      color: #1e40af;
      margin: 0 0 15px 0;
      font-size: 1.1em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .new-data-input h5 i {
      color: #3b82f6;
    }

    .new-data-input textarea {
      border: 2px solid #e5e7eb !important;
      transition: all 0.3s ease;
    }

    .new-data-input textarea:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
      outline: none;
    }

    /* Claude Analysis Specific Styles */
    .claude-analysis {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border-left: 4px solid #0ea5e9;
      padding: 20px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .claude-analysis h5 {
      color: #0c4a6e;
      margin: 0 0 15px 0;
    }

    .claude-analysis ul {
      margin: 10px 0;
      padding-left: 20px;
    }

    .claude-analysis li {
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .demo-analysis {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-left: 4px solid #f59e0b;
      padding: 20px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .demo-analysis h5 {
      color: #92400e;
      margin: 0 0 15px 0;
    }

    .loading-dots {
      display: flex;
      gap: 4px;
      justify-content: center;
      margin-top: 10px;
    }

    .loading-dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #3b82f6;
      animation: loading-bounce 1.4s ease-in-out infinite both;
    }

    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes loading-bounce {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
      40% { transform: scale(1.2); opacity: 1; }
    }

    /* Right Column Sections */
    .summary-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .summary-section h3 {
      margin: 0 0 15px 0;
      color: #333;
    }

    .summary-field {
      margin-bottom: 15px;
    }

    .summary-field label {
      display: block;
      font-size: 0.9em;
      color: #666;
      margin-bottom: 5px;
    }

    .summary-field input,
    .summary-field textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9em;
      box-sizing: border-box;
    }

    .summary-field textarea {
      height: 100px;
      resize: vertical;
    }

    .save-btn {
      background: #22c55e;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .action-btn {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }

    .generate-cr-btn {
      background: #22c55e;
      color: white;
    }

    .download-btn {
      background: #6c757d;
      color: white;
    }

    /* Footer */
    footer {
      background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 5px;
      text-align: center;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }
    .footer-icons {
      margin-top: 10px;
    }
    .footer-icons a {
      color: white;
      margin: 0 10px;
      font-size: 20px;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    .footer-icons a:hover {
      color: #bdc3c7;
      transform: translateY(-2px);
    }

    .help-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .help-content {
      font-size: 0.85em;
      line-height: 1.5;
      color: #666;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <!-- Logo in top-left -->
    <img src="footer-logo.png" alt="Logo">
    <h1>Automated Unified Regulatory Assistant</h1>
    <p>AURA - Turning Regulatory Chaos into Clarity</p>
    <div class="user-section">
      <div class="user-avatar">
        <i class="fas fa-user-shield"></i>
      </div>
      <div class="user-info">
        <div class="user-role">Admin</div>
        <div class="user-status">
          <span class="status-dot"></span>
          System Administrator
        </div>
      </div>
      <div class="header-actions">
        <button class="action-btn notification-btn" title="Notifications">
          <i class="fas fa-bell"></i>
          <span class="notification-badge">3</span>
        </button>
        <button class="action-btn settings-btn" title="Settings">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>
  </div>
 
  <!-- Content -->
  <div class="content-wrapper">
    <!-- Sidebar -->
    <div class="sidebar">
      <a href="index.html" class="active"><i class="fa-solid fa-house"></i> Home</a>
      <a href="ria.html"><i class="fa-solid fa-robot"></i> RIA</a>
      <a href="rise.html"><i class="fa-solid fa-bolt"></i> RISE</a>
      <a href="prism.html"><i class="fa-solid fa-database"></i> PRISM</a>
      
      <!-- Quick Stats KPIs -->
      <div class="quick-stats">
        <div class="stats-header">
          <i class="fas fa-chart-bar"></i>
          <h4>Quick Stats</h4>
        </div>
        
        <div class="stat-item">
          <div class="stat-label">Active Alerts</div>
          <div class="stat-value">15</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 2
          </div>
        </div>
        
        <div class="stat-item">
          <div class="stat-label">Products</div>
          <div class="stat-value">142</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 3
          </div>
        </div>
        
        <div class="stat-item">
          <div class="stat-label">Compliance</div>
          <div class="stat-value">98.2%</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 0.3%
          </div>
        </div>
        
        <div class="stat-item">
          <div class="stat-label">On-Time</div>
          <div class="stat-value">94.1%</div>
          <div class="stat-change negative">
            <i class="fas fa-arrow-down"></i> 1.2%
          </div>
        </div>
      </div>
    </div>
 
    <!-- Main Content -->
    <div class="main">
      <!-- RIA Header -->
      <div class="ria-header">
        <h1>Regulatory Impact Analyzer</h1>
        <p>RIA - AI-powered regulatory monitoring and impact analysis system</p>
      </div>

      <!-- Filters Section -->
      <div class="filters-section">
        <h3><i class="fa-solid fa-filter"></i> FILTERS</h3>
        <div class="filters-row">
          <div class="filter-group">
            <label>Search by Regulatory Updates</label>
            <select>
              <option>All Updates</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Search by Agency</label>
            <select>
              <option>All Agencies</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Search by Date</label>
            <select>
              <option>All Dates</option>
            </select>
          </div>
        </div>
        
        <!-- News Feed Form -->
        <div class="news-feed-form">
          <div class="news-feed-header">
            <h3><i class="fas fa-newspaper"></i> REGULATORY NEWS FEED</h3>
          </div>
          
          <!-- Additional News Items -->
          <div class="additional-news">
            
            <!-- Latest ODDA - Opioid Prescribing Info Update -->
            <div class="news-item expanded" onclick="populateImpactTable('opioid-prescribing')">
              <div class="news-item-header">
                <div class="news-badges-left">
                  <div class="news-badge recent">ODDA</div>
                </div>
              </div>
              <div class="news-content">
                <div class="news-content-main">
                  <div class="news-title">ODDA Requires Opioid Pain Medicine Manufacturers to Update Prescribing Information (Long-Term Use)</div>
                  <div class="news-meta">
                    <span class="news-agency"><i class="fas fa-building"></i> ODDA</span>
                    <span class="news-date"><i class="fas fa-calendar"></i> September 10, 2025 - 4:45 PM</span>
                    <span class="time-left"><i class="fas fa-hourglass-half"></i> 180 days to implement</span>
                  </div>
                  <div class="news-preview">
                    ODDA reviewed new PMR studies and requires labeling updates for long-term opioid therapy including clearer risk language, naloxone guidance, tapering recommendations, and monitoring for misuse and overdose.
                  </div>
                  <div class="news-bottom-row">
                    <div class="news-actions">
                      <button class="impact-analyze-btn" onclick="event.stopPropagation(); populateImpactTable('opioid-prescribing')">
                        <i class="fas fa-chart-line"></i> Impact Analyse
                      </button>
                      <button class="view-full-btn" onclick="event.stopPropagation(); window.open('https://perimaitri17.github.io/odda/opioid_prescribing_info.html', '_blank')">
                        <i class="fas fa-external-link-alt"></i> View Full Details
                      </button>
                    </div>
                    <div class="impacted-documents-badges">
                      <div class="document-count-badge">
                        <i class="fas fa-file-alt"></i>
                        <span>04 Impacted Documents</span>
                      </div>
                      <div class="new-badge">NEW</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            
            <!-- Collapsible Items -->
            <div class="collapsible-section">
              <div class="collapse-header" onclick="toggleCollapse()">
                <span><i class="fas fa-eye"></i> Show 2 more updates</span>
                <i class="fas fa-chevron-down collapse-icon"></i>
              </div>
              
              <div class="collapsed-content" id="collapsedNews">
                <!-- Latest FDA News #1 - Green Lumber Counterfeit Alert -->
                <div class="news-item collapsed" onclick="openNewsModal('green-lumber-alert')">
                  <div class="news-badge">FDA</div>
                  <div class="news-content">
                    <div class="news-title">Green Lumber Holding, LLC Issues Consumer Alert on Counterfeit Products Following FDA Findings</div>
                    <div class="news-meta">
                      <span class="news-agency"><i class="fas fa-building"></i> FDA</span>
                      <span class="news-date"><i class="fas fa-calendar"></i> August 29, 2025</span>
                      <span class="time-left"><i class="fas fa-hourglass-half"></i> Drug Recall</span>
                    </div>
                  </div>
                </div>
                
                <!-- Latest FDA News #2 - Leqembi MRI Monitoring -->
                <div class="news-item collapsed" onclick="openNewsModal('leqembi-monitoring')">
                  <div class="news-badge">FDA</div>
                  <div class="news-content">
                    <div class="news-title">FDA to recommend additional, earlier MRI monitoring for patients with Alzheimer's disease taking Leqembi (lecanemab)</div>
                    <div class="news-meta">
                      <span class="news-agency"><i class="fas fa-building"></i> FDA</span>
                      <span class="news-date"><i class="fas fa-calendar"></i> August 28, 2025</span>
                      <span class="time-left"><i class="fas fa-hourglass-half"></i> Drug Safety</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Content Grid -->
      <div class="content-grid">
        <!-- Left Column -->
        <div class="left-column">
          <!-- Impact Section -->
          <div class="impact-section">
            <h3>IMPACT</h3>
            <table class="impact-table">
              <thead>
                <tr>
                  <th>NEWS FEED</th>
                  <th>THERAPEUTIC AREA</th>
                  <th>DRUG</th>
                  <th>DOSAGE</th>
                  <th>MARKET</th>
                  <th>DOCUMENT ID</th>
                  <th>DOCUMENT NAME</th>
                  <th>SUBMISSION ID</th>
                  <th>ANALYSE IMPACT</th>
                </tr>
              </thead>
              <tbody id="impactTableBody">
                <tr id="impactRow1">
                  <td id="newsFeed1"></td>
                  <td id="therapeuticArea1"></td>
                  <td id="brand1"></td>
                  <td id="dosage1"></td>
                  <td id="market1"></td>
                  <td id="documentId1"></td>
                  <td id="documentName1"></td>
                  <td id="submissionId1"></td>
                  <td>
                    <button class="analyse-btn disabled" onclick="analyzeImpact(1)" disabled>Analyse</button>
                  </td>
                </tr>
                <tr id="impactRow2">
                  <td id="newsFeed2"></td>
                  <td id="therapeuticArea2"></td>
                  <td id="brand2"></td>
                  <td id="dosage2"></td>
                  <td id="market2"></td>
                  <td id="documentId2"></td>
                  <td id="documentName2"></td>
                  <td id="submissionId2"></td>
                  <td>
                    <button class="analyse-btn disabled" onclick="analyzeImpact(2)" disabled>Analyse</button>
                  </td>
                </tr>
                <tr id="impactRow3">
                  <td id="newsFeed3"></td>
                  <td id="therapeuticArea3"></td>
                  <td id="brand3"></td>
                  <td id="dosage3"></td>
                  <td id="market3"></td>
                  <td id="documentId3"></td>
                  <td id="documentName3"></td>
                  <td id="submissionId3"></td>
                  <td>
                    <button class="analyse-btn disabled" onclick="analyzeImpact(3)" disabled>Analyse</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Analysis Section -->
          <div class="analysis-section" id="analysisSection">
            <h3>ANALYSIS</h3>
            <div class="analysis-grid-three">
              <!-- Card 1: Original Document -->
              <div class="analysis-column">
                <h4>Original Document</h4>
                <div class="impacted-data-display" id="impactedDataDisplay">
                  <div class="no-analysis-message">
                    Click "Analyse" button from the Impact table to view detailed analysis
                  </div>
                </div>
              </div>
              
              <!-- Card 2: AI Draft with Comparison Data -->
              <div class="analysis-column">
                <h4>AI Draft</h4>
                <div class="llm-comparison-display" id="llmComparisonDisplay">
                  <div class="no-analysis-message">
                    Complete the impact analysis first to generate AI draft comparison
                  </div>
                </div>
                <button class="download-comparison-btn" id="downloadComparisonBtn" onclick="downloadComparison()" style="display: none;">
                  <i class="fas fa-download"></i> Download Comparison Document
                </button>
              </div>
              
              <!-- Card 3: AI Chat Box for Modifications -->
              <div class="analysis-column">
                <h4>Modify AI Draft</h4>
                <div class="ai-chat-container" id="aiChatContainer">
                  <div class="chat-messages" id="chatMessages">
                    <div class="initial-chat-message">
                      <i class="fas fa-robot"></i>
                      <p>Hello! I'm your AI assistant. You can ask me to modify the AI draft, suggest improvements, or answer questions about the regulatory comparison.</p>
                    </div>
                  </div>
                  <div class="chat-input-section">
                    <textarea 
                      id="chatInput" 
                      placeholder="Ask me to modify the AI draft, explain regulations, or suggest improvements..."
                      rows="3"
                      class="chat-input-box">
                    </textarea>
                    <button class="send-chat-btn" onclick="sendChatMessage()" id="sendChatBtn">
                      <i class="fas fa-paper-plane"></i> Send
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Fourth Card: Key Changes -->
            <div class="key-changes-section">
              <div class="key-changes-card">
                <h4>Key Changes</h4>
                <div class="key-changes-display" id="keyChangesDisplay">
                  <div class="no-changes-message">
                    <i class="fas fa-info-circle"></i>
                    <p>Complete the impact analysis to view key regulatory changes and their implications</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function generateModifiedDocument() {
      // Show loading state
      const btn = event.target;
      const originalText = btn.innerHTML;
      btn.innerHTML = 'Generating...';
      btn.disabled = true;

      // Simulate AI processing time
      setTimeout(() => {
        // Show the result in the third column
        const generatedContent = document.getElementById('generatedContent');
        const downloadBtn = document.getElementById('downloadBtn');
        const noDocumentMessage = document.querySelector('.no-document-message');
        
        // Sample generated content
        const generatedText = `MODIFIED DOCUMENT - FDA COMPLIANCE UPDATE

Section 3.2: Quality Control Standards
UPDATED: Bi-weekly testing protocol
- Previous: Monthly testing
- New: Testing every 14 days
- Implementation: Dec 15, 2024

Section 4.1: Documentation Protocol  
UPDATED: Electronic submission format
- Previous: PDF submission
- New: Structured electronic data
- Validation: XML schema required

Section 5.3: Manufacturing Guidelines
UPDATED: ISO 14001 standard adoption
- Previous: ISO 9001 quality mgmt
- New: Environmental mgmt integration
- Audit: Q1 2025 certification

Section 6.2: Validation Requirements
UPDATED: Accelerated timeline
- Previous: 30-day validation
- New: 15-day expedited validation
- Risk Assessment: Parallel processing

Section 7.1: Compliance Monitoring
UPDATED: Monthly monitoring
- Previous: Quarterly checks
- New: Monthly systematic reviews
- Alerts: Real-time notifications

Section 8.4: Reporting Standards
UPDATED: Automated reporting
- Previous: Manual generation
- New: Automated system integration
- Data Flow: Real-time dashboard

IMPLEMENTATION CHECKLIST:
 Update SOPs by Nov 1, 2024
 Train staff by Nov 15, 2024  
 Install systems by Dec 1, 2024
 Complete validation by Dec 10, 2024
 Full compliance by Dec 15, 2024

COST IMPACT: $125,000 - $175,000
TIMELINE: 97 days remaining`;

        generatedContent.textContent = generatedText;
        
        // Hide no document message and show content
        noDocumentMessage.style.display = 'none';
        generatedContent.style.display = 'block';
        downloadBtn.style.display = 'block';
        
        // Reset button
        btn.innerHTML = originalText;
        btn.disabled = false;
      }, 2000);
    }

    function downloadResult() {
      const generatedContent = document.getElementById('generatedContent');
      
      // Check if there's content to download
      if (generatedContent.style.display === 'none' || !generatedContent.textContent.trim()) {
        alert('Please generate a document first before downloading.');
        return;
      }
      
      const resultText = generatedContent.textContent;
      const blob = new Blob([resultText], { type: 'text/plain' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'FDA_Modified_Document_' + new Date().toISOString().split('T')[0] + '.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
    }

    // News Database (synced with home.html)
    const newsDatabase = {
      "oncology-manufacturing": {
        title: "This is a new update for Oncology drugs manufacturing units",
        date: "2 hours ago",
        source: "FDA",
        category: "Manufacturing",
        summary: "The FDA has issued new guidelines for oncology drug manufacturing facilities to enhance quality control and ensure patient safety across all production stages.",
        details: `
          <p>The Food and Drug Administration has released comprehensive updates to manufacturing standards for oncology medications, focusing on:</p>
          <ul>
            <li><strong>Enhanced Quality Control:</strong> Implementation of advanced testing protocols at every production stage</li>
            <li><strong>Contamination Prevention:</strong> Stricter cleanroom requirements and environmental monitoring</li>
            <li><strong>Supply Chain Integrity:</strong> New tracking requirements for raw materials and active pharmaceutical ingredients</li>
            <li><strong>Documentation Standards:</strong> Updated record-keeping requirements for batch production</li>
          </ul>
          <p>These changes affect all manufacturers of oncology drugs and must be implemented within 180 days of the notice publication.</p>
        `,
        lastUpdated: "September 10, 2025 2:30 PM",
        agency: "FDA",
        announcementDate: "September 10, 2025",
        effectiveDate: "December 15, 2024",
        implementationDays: "97"
      },
      "cardiovascular-safety": {
        title: "New FDA guidance on Oncology drug development protocols",
        date: "Just now",
        source: "FDA",
        category: "Drug Development",
        summary: "FDA introduces updated protocols for oncology drug development focusing on accelerated approval pathways and real-world evidence requirements.",
        details: `
          <p>The FDA has announced significant updates to oncology drug development protocols, introducing new pathways for faster patient access to breakthrough therapies:</p>
          <ul>
            <li><strong>Accelerated Approval Enhancements:</strong> Streamlined processes for drugs treating unmet medical needs</li>
            <li><strong>Real-World Evidence Integration:</strong> New requirements for post-market surveillance and data collection</li>
            <li><strong>Biomarker Validation:</strong> Updated standards for companion diagnostics and personalized medicine approaches</li>
            <li><strong>Clinical Trial Design:</strong> Flexible trial designs including adaptive and umbrella studies</li>
          </ul>
          <p>These protocols aim to reduce development timelines by an average of 18 months while maintaining rigorous safety standards.</p>
        `,
        lastUpdated: "September 10, 2025 4:45 PM",
        agency: "FDA",
        announcementDate: "September 10, 2025",
        effectiveDate: "March 15, 2026",
        implementationDays: "180"
      },
      "biologics-standards": {
        title: "Updated safety requirements for cardiovascular medications",
        date: "15 minutes ago",
        source: "FDA",
        category: "Drug Safety",
        summary: "Enhanced safety monitoring requirements for cardiovascular medications including new adverse event reporting protocols and post-market surveillance measures.",
        details: `
          <p>The FDA has implemented comprehensive safety updates for cardiovascular medications following recent safety signal analysis:</p>
          <ul>
            <li><strong>Enhanced Monitoring:</strong> Mandatory reporting of specific cardiovascular events within 15 days</li>
            <li><strong>Risk Evaluation Programs:</strong> New REMS requirements for high-risk cardiovascular drugs</li>
            <li><strong>Patient Registries:</strong> Establishment of national cardiovascular drug safety database</li>
            <li><strong>Healthcare Provider Training:</strong> Mandatory educational programs on cardiovascular drug safety</li>
          </ul>
          <p>These measures apply to all cardiovascular medications approved after 2020 and selected legacy drugs with updated risk profiles.</p>
        `,
        lastUpdated: "September 10, 2025 4:30 PM",
        agency: "FDA",
        announcementDate: "September 10, 2025",
        effectiveDate: "January 25, 2026",
        implementationDays: "106"
      },
      "labeling-requirements": {
        title: "FDA approves new manufacturing standards for biologics",
        date: "1 hour ago",
        source: "FDA",
        category: "Biologics",
        summary: "Revolutionary manufacturing standards for biologics production focusing on advanced analytics, process validation, and quality assurance protocols.",
        details: `
          <p>The FDA has approved groundbreaking manufacturing standards for biologics that leverage cutting-edge technology and data analytics:</p>
          <ul>
            <li><strong>Process Analytical Technology:</strong> Real-time monitoring and control of critical quality attributes</li>
            <li><strong>Continuous Manufacturing:</strong> Approval framework for continuous biologics production processes</li>
            <li><strong>Advanced Analytics:</strong> Machine learning applications for quality prediction and process optimization</li>
            <li><strong>Facility Design Standards:</strong> Modular and flexible facility requirements for next-generation biologics</li>
          </ul>
          <p>These standards represent a paradigm shift towards Industry 4.0 principles in biologics manufacturing, potentially reducing production costs by 30-40%.</p>
        `,
        lastUpdated: "September 10, 2025 3:45 PM",
        agency: "FDA",
        announcementDate: "September 10, 2025",
        effectiveDate: "January 15, 2028",
        implementationDays: "843"
      }
    };

    // Modal functionality for news items
    function openNewsModal(newsId) {
      const newsData = newsDatabase[newsId];
      if (!newsData) return;

      // Create modal if it doesn't exist
      let modal = document.getElementById('newsModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'newsModal';
        modal.innerHTML = `
          <div class="modal-overlay" onclick="closeNewsModal()"></div>
          <div class="modal-content">
            <div class="modal-header">
              <h2 id="modalTitle"></h2>
              <button onclick="closeNewsModal()" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
              <div class="modal-meta" id="modalMeta"></div>
              <div class="modal-details" id="modalDetails"></div>
            </div>
          </div>
        `;
        modal.style.cssText = `
          position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;
          display: none; align-items: center; justify-content: center;
        `;
        
        // Add modal styles
        const modalStyle = document.createElement('style');
        modalStyle.textContent = `
          .modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(5px); }
          .modal-content { position: relative; background: white; max-width: 800px; max-height: 80vh; overflow-y: auto; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); margin: 20px; }
          .modal-header { padding: 20px; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center; background: #3e9ca8; color: white; }
          .modal-header h2 { margin: 0; font-size: 1.3em; }
          .close-btn { background: none; border: none; font-size: 24px; color: white; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; }
          .modal-body { padding: 20px; }
          .modal-meta { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          .modal-meta div { margin: 5px 0; }
          .modal-details { line-height: 1.6; }
          .modal-details ul { padding-left: 20px; }
          .modal-details li { margin: 8px 0; }
        `;
        document.head.appendChild(modalStyle);
        document.body.appendChild(modal);
      }

      // Update modal content
      document.getElementById('modalTitle').textContent = newsData.title;
      document.getElementById('modalMeta').innerHTML = `
        <div><strong>Agency:</strong> ${newsData.agency}</div>
        <div><strong>Category:</strong> ${newsData.category}</div>
        <div><strong>Date of Announcement:</strong> ${newsData.announcementDate}</div>
        <div><strong>Implementation Days:</strong> ${newsData.implementationDays} days</div>
        <div><strong>Last Updated:</strong> ${newsData.lastUpdated}</div>
      `;
      document.getElementById('modalDetails').innerHTML = newsData.details;
      
      modal.style.display = 'flex';
    }

    function closeNewsModal() {
      const modal = document.getElementById('newsModal');
      if (modal) modal.style.display = 'none';
    }

    // Toggle collapse functionality
    function toggleCollapse() {
      const collapsedContent = document.getElementById('collapsedNews');
      const collapseHeader = document.querySelector('.collapse-header');
      const headerText = collapseHeader.querySelector('span');
      
      if (collapsedContent.classList.contains('show')) {
        // Collapse
        collapsedContent.classList.remove('show');
        collapseHeader.classList.remove('active');
        headerText.textContent = 'Show 2 More Updates';
      } else {
        // Expand
        collapsedContent.classList.add('show');
        collapseHeader.classList.add('active');
        headerText.textContent = 'Hide Additional Updates';
      }
    }

    // Populate Impact Table with dummy data
    function populateImpactTable(newsId) {
      const impactData = [
        {
          newsFeed: "FDA Oncology Guidance Update",
          therapeuticArea: "Oncology",
          brand: "OncoCure Plus",
          dosage: "250mg Tablets",
          market: "US/EU",
          documentId: "DOC-2025-001",
          documentName: "Clinical Study Protocol v2.1",
          submissionId: "SUB-PHI-2026-Q2"
        },
        {
          newsFeed: "Manufacturing Standards Update",
          therapeuticArea: "Immunology", 
          brand: "ImmunoFlex Pro",
          dosage: "5mg/ml Injectable",
          market: "Global",
          documentId: "DOC-2025-002",
          documentName: "Manufacturing Process Manual v3.0",
          submissionId: "SUB-BLA-2025-Q4"
        },
        {
          newsFeed: "Quality Control Requirements",
          therapeuticArea: "Cardiovascular",
          brand: "CardioShield Advanced",
          dosage: "50mg/100mg Capsules",
          market: "US/Canada",
          documentId: "DOC-2025-003",
          documentName: "Quality Control SOP v1.5",
          submissionId: "SUB-NDA-2026-Q1"
        }
      ];

      // Populate the table rows
      impactData.forEach((data, index) => {
        const rowNum = index + 1;
        document.getElementById(`newsFeed${rowNum}`).textContent = data.newsFeed;
        document.getElementById(`therapeuticArea${rowNum}`).textContent = data.therapeuticArea;
        document.getElementById(`brand${rowNum}`).textContent = data.brand;
        document.getElementById(`dosage${rowNum}`).textContent = data.dosage;
        document.getElementById(`market${rowNum}`).textContent = data.market;
        document.getElementById(`documentId${rowNum}`).textContent = data.documentId;
        document.getElementById(`documentName${rowNum}`).textContent = data.documentName;
        document.getElementById(`submissionId${rowNum}`).textContent = data.submissionId;
      });

      // Enable all Analyse buttons
      const analyseButtons = document.querySelectorAll('.analyse-btn');
      analyseButtons.forEach(button => {
        button.disabled = false;
        button.classList.remove('disabled');
        button.style.animation = 'pulse-ready 2s infinite';
      });

      // Add visual feedback that table has been populated
      const impactSection = document.querySelector('.impact-section');
      impactSection.style.border = '2px solid #3e9ca8';
      impactSection.style.boxShadow = '0 4px 12px rgba(62, 156, 168, 0.2)';
      
      // Show notification that buttons are now enabled
      const notification = document.createElement('div');
      notification.innerHTML = `
        <div style="
          position: fixed; 
          top: 20px; 
          right: 20px; 
          background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); 
          color: white; 
          padding: 12px 20px; 
          border-radius: 8px; 
          box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
          z-index: 1000;
          font-weight: 600;
          animation: slideIn 0.5s ease;
        ">
          <i class="fas fa-check-circle"></i> Impact table populated! Analyse buttons are now active.
        </div>
      `;
      
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideIn {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
      `;
      document.head.appendChild(style);
      document.body.appendChild(notification);
      
      // Remove notification after 4 seconds
      setTimeout(() => {
        notification.remove();
        style.remove();
      }, 4000);
      
      // Scroll to impact table
      impactSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      
      // Remove highlight after 3 seconds
      setTimeout(() => {
        impactSection.style.border = '';
        impactSection.style.boxShadow = '';
      }, 3000);
    }

    // Analysis function for each news feed
    function analyzeImpact(rowNumber) {
      // Check if button is enabled
      const button = event.target;
      if (button.disabled || button.classList.contains('disabled')) {
        // Show message that they need to click regulatory update first
        const warningNotification = document.createElement('div');
        warningNotification.innerHTML = `
          <div style="
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; 
            padding: 12px 20px; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.5s ease;
            max-width: 300px;
          ">
            <i class="fas fa-exclamation-triangle"></i> Please click a Recent Regulatory Update first to populate the Impact table!
          </div>
        `;
        document.body.appendChild(warningNotification);
        
        setTimeout(() => {
          warningNotification.remove();
        }, 4000);
        return;
      }

      const analysisData = {
        1: { // Oncology
          impactedData: [
            {
              section: "Trial Design Standards",
              content: "Current requirement: Traditional Phase I-III sequential design"
            },
            {
              section: "Biomarker Validation",
              content: "Current standard: Single biomarker companion diagnostics"
            },
            {
              section: "Accelerated Approval Pathway",
              content: "Current timeline: 12-18 months review process"
            },
            {
              section: "Real-World Evidence Integration",
              content: "Current approach: Post-market surveillance only"
            },
            {
              section: "Regulatory Submission Format",
              content: "Current method: Traditional eCTD modules"
            }
          ],
          newsType: "Oncology Drug Development"
        },
        2: { // Immunology  
          impactedData: [
            {
              section: "Manufacturing Standards",
              content: "Current requirement: Batch production protocols only"
            },
            {
              section: "Process Analytical Technology",
              content: "Current approach: End-product testing methodology"
            },
            {
              section: "Quality Control Systems",
              content: "Current method: Manual sampling and testing procedures"
            },
            {
              section: "Facility Design Requirements",
              content: "Current standard: Traditional fixed layout configurations"
            },
            {
              section: "Advanced Analytics Integration",
              content: "Current capability: Basic statistical analysis tools"
            }
          ],
          newsType: "Immunology Manufacturing"
        },
        3: { // Cardiovascular
          impactedData: [
            {
              section: "Safety Monitoring Protocols",
              content: "Current requirement: Standard AESI reporting procedures"
            },
            {
              section: "Risk Evaluation Programs",
              content: "Current scope: High-risk drugs only coverage"
            },
            {
              section: "Patient Registry Systems",
              content: "Current coverage: Limited post-market data collection"
            },
            {
              section: "Healthcare Provider Training",
              content: "Current standard: Optional continuing education programs"
            },
            {
              section: "Adverse Event Reporting",
              content: "Current timeline: 15-day expedited reporting requirement"
            }
          ],
          newsType: "Cardiovascular Safety"
        }
      };

      const data = analysisData[rowNumber];
      if (!data) return;

      // Show loading state
      const impactedDisplay = document.getElementById('impactedDataDisplay');
      const comparisonDisplay = document.getElementById('llmComparisonDisplay');
      const analysisSection = document.getElementById('analysisSection');
      
      impactedDisplay.innerHTML = '<div class="analysis-loading"><i class="fas fa-spinner fa-spin"></i> Analyzing impact...</div>';
      comparisonDisplay.innerHTML = '<div class="analysis-loading"><i class="fas fa-spinner fa-spin"></i> Generating comparison...</div>';
      
      // Highlight analysis section
      analysisSection.style.border = '2px solid #3e9ca8';
      analysisSection.style.boxShadow = '0 4px 12px rgba(62, 156, 168, 0.2)';
      
      // Scroll to analysis section
      analysisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Simulate analysis time
      setTimeout(() => {
        // Populate only impacted data first
        let impactedHTML = `
          <div class="analysis-header">
            <span>Document Analysis Complete</span>
            <span class="analysis-status">${data.newsType}</span>
          </div>
        `;
        data.impactedData.forEach(item => {
          impactedHTML += `
            <div class="data-item">
              <span class="section-title">${item.section}</span>
              <span class="section-content">${item.content}</span>
            </div>
          `;
        });
        impactedDisplay.innerHTML = impactedHTML;
        impactedDisplay.className = 'impacted-data-display analysis-active';

        // Automatically populate AI Draft with comparison data
        const comparisonData = {
          1: { // Oncology
            comparison: [
              "<strong>Trial Design:</strong> New adaptive and umbrella study designs vs traditional sequential phases",
              "<strong>Biomarkers:</strong> Multi-biomarker panels required vs single companion diagnostics", 
              "<strong>Approval Timeline:</strong> Streamlined 6-8 month review vs current 12-18 months",
              "<strong>Real-World Evidence:</strong> Integrated throughout development vs post-market only",
              "<strong>Submission Format:</strong> Enhanced digital submissions with interactive datasets"
            ]
          },
          2: { // Manufacturing  
            comparison: [
              "<strong>Manufacturing:</strong> Continuous production processes vs traditional batch methods",
              "<strong>Analytics:</strong> Real-time PAT monitoring vs end-product testing only",
              "<strong>Quality Control:</strong> Automated systems with AI vs manual sampling",
              "<strong>Facility Design:</strong> Modular flexible layouts vs traditional fixed designs",
              "<strong>Data Integration:</strong> Machine learning analytics vs basic statistical methods"
            ]
          },
          3: { // Cardiovascular
            comparison: [
              "<strong>Safety Monitoring:</strong> Enhanced cardiovascular-specific protocols vs standard AESI",
              "<strong>Risk Programs:</strong> Expanded REMS for broader drug categories vs high-risk only",
              "<strong>Patient Registries:</strong> Comprehensive national database vs limited coverage",
              "<strong>Provider Training:</strong> Mandatory certification programs vs optional education",
              "<strong>Reporting Timeline:</strong> Accelerated 7-day reporting for CV events vs 15-day standard"
            ]
          }
        };

        const comparisonAnalysis = comparisonData[rowNumber];
        if (comparisonAnalysis) {
          let comparisonHTML = `
            <div class="analysis-header">
              <span><i class="fas fa-robot"></i> AI Draft Analysis</span>
              <span class="analysis-status">Generated by Claude</span>
            </div>
            <div class="ai-draft-content">
          `;
          comparisonAnalysis.comparison.forEach(item => {
            comparisonHTML += `<div class="comparison-item">${item}</div>`;
          });
          comparisonHTML += '</div>';
          
          comparisonDisplay.innerHTML = comparisonHTML;
          comparisonDisplay.className = 'llm-comparison-display analysis-active';
          
          // Show download comparison button
          const downloadComparisonBtn = document.getElementById('downloadComparisonBtn');
          downloadComparisonBtn.style.display = 'block';
        }

        // Populate Key Changes data
        const keyChangesData = {
          1: { // Oncology
            changes: [
              {
                title: "Adaptive Trial Designs",
                description: "Implementation of flexible trial designs allowing modifications based on interim results",
                impact: "High Impact"
              },
              {
                title: "Biomarker Integration",
                description: "Mandatory multi-biomarker companion diagnostics for precision medicine approaches",
                impact: "Medium Impact"
              },
              {
                title: "Digital Submissions",
                description: "Enhanced electronic submission requirements with interactive data visualization",
                impact: "Medium Impact"
              },
              {
                title: "Accelerated Review",
                description: "Streamlined review process reducing approval timeline by 6-10 months",
                impact: "High Impact"
              }
            ]
          },
          2: { // Manufacturing
            changes: [
              {
                title: "Continuous Manufacturing",
                description: "Shift from batch to continuous production processes with real-time monitoring",
                impact: "High Impact"
              },
              {
                title: "Process Analytics",
                description: "Implementation of advanced PAT systems for real-time quality control",
                impact: "Medium Impact"
              },
              {
                title: "AI Integration",
                description: "Machine learning applications for predictive quality and process optimization",
                impact: "High Impact"
              },
              {
                title: "Facility Modernization",
                description: "Modular and flexible facility designs to accommodate next-generation processes",
                impact: "Medium Impact"
              }
            ]
          },
          3: { // Cardiovascular
            changes: [
              {
                title: "Enhanced Monitoring",
                description: "Cardiovascular-specific safety protocols beyond standard AESI requirements",
                impact: "High Impact"
              },
              {
                title: "Expanded REMS",
                description: "Risk evaluation and mitigation strategies for broader drug categories",
                impact: "Medium Impact"
              },
              {
                title: "National Registry",
                description: "Comprehensive cardiovascular drug safety database for post-market surveillance",
                impact: "High Impact"
              },
              {
                title: "Provider Certification",
                description: "Mandatory training and certification programs for healthcare providers",
                impact: "Medium Impact"
              }
            ]
          }
        };

        const keyChanges = keyChangesData[rowNumber];
        const keyChangesDisplay = document.getElementById('keyChangesDisplay');
        
        if (keyChanges) {
          let keyChangesHTML = '<div class="key-changes-content">';
          keyChanges.changes.forEach(change => {
            keyChangesHTML += `
              <div class="key-change-item">
                <div class="key-change-title">
                  <i class="fas fa-arrow-right"></i>
                  ${change.title}
                </div>
                <div class="key-change-description">${change.description}</div>
                <div class="key-change-impact">${change.impact}</div>
              </div>
            `;
          });
          keyChangesHTML += '</div>';
          
          keyChangesDisplay.innerHTML = keyChangesHTML;
        }
        
        // Update analysis section styling
        analysisSection.style.border = '2px solid #22c55e';
        analysisSection.style.boxShadow = '0 4px 12px rgba(34, 197, 94, 0.2)';
        
        // Remove highlight after 5 seconds
        setTimeout(() => {
          analysisSection.style.border = '';
          analysisSection.style.boxShadow = '';
        }, 5000);
        
      }, 2000); // 2 second delay to show loading
    }

    // Function to generate comparison data using AWS Bedrock Claude
    async function generateComparison() {
      const button = document.getElementById('generateComparisonBtn');
      const rowNumber = button.getAttribute('data-row');
      const newDataTextarea = document.getElementById('newRegulationData');
      const newData = newDataTextarea.value.trim();
      
      // Validation
      if (!newData) {
        alert('Please enter new regulation data for comparison.');
        newDataTextarea.focus();
        return;
      }
      
      // Get old data based on row number
      const oldDataMapping = {
        1: "Current FDA oncology drug development guidelines require traditional sequential phase trials with single biomarker companion diagnostics. Standard approval timeline is 12-18 months with post-market surveillance for real-world evidence collection.",
        2: "Existing manufacturing standards use batch production methods with end-product testing and manual quality control sampling. Facilities follow traditional fixed designs with basic statistical analysis methods.",
        3: "Current cardiovascular medication safety monitoring uses standard Adverse Events of Special Interest (AESI) protocols. REMS programs apply only to high-risk medications with optional provider education and 15-day reporting timelines."
      };
      
      const oldData = oldDataMapping[rowNumber] || "Current regulatory framework";
      const regulationType = rowNumber === '1' ? 'Oncology' : rowNumber === '2' ? 'Manufacturing' : 'Cardiovascular';
      
      // Show loading state
      const comparisonDisplay = document.getElementById('llmComparisonDisplay');
      comparisonDisplay.innerHTML = `
        <div class="analysis-loading">
          <i class="fas fa-brain fa-spin"></i> 
          <p>Claude AI is analyzing and comparing regulatory data...</p>
          <div class="loading-dots">
            <span></span><span></span><span></span>
          </div>
        </div>
      `;
      
      // Update button state
      button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
      button.disabled = true;
      
      try {
        // Call AWS Lambda function with Bedrock Claude
        const response = await fetch('YOUR_API_GATEWAY_URL_HERE', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Access-Control-Allow-Origin': '*'
          },
          body: JSON.stringify({
            oldData: oldData,
            newData: newData,
            regulationType: regulationType
          })
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        const claudeAnalysis = result.analysis || result.body || result.response || "Analysis completed successfully.";
        
        // Display Claude's analysis
        comparisonDisplay.innerHTML = `
          <div class="analysis-header">
            <span><i class="fas fa-robot"></i> Claude AI Analysis Complete</span>
            <span class="analysis-status">Powered by AWS Bedrock</span>
          </div>
          <div class="claude-analysis">
            ${formatClaudeResponse(claudeAnalysis)}
          </div>
        `;
        
        comparisonDisplay.className = 'llm-comparison-display analysis-active';
        
        // Show the final generate document button
        document.getElementById('generateBtn').style.display = 'block';
        
        // Success highlighting
        comparisonDisplay.style.border = '2px solid #10b981';
        comparisonDisplay.style.borderRadius = '8px';
        comparisonDisplay.style.padding = '15px';
        
        setTimeout(() => {
          comparisonDisplay.style.border = '';
          comparisonDisplay.style.padding = '';
        }, 3000);
        
      } catch (error) {
        console.error('Error calling Claude API:', error);
        
        // Fallback to demo analysis if API fails
        comparisonDisplay.innerHTML = `
          <div class="analysis-header">
            <span><i class="fas fa-exclamation-triangle"></i> Demo Mode (Claude API not configured)</span>
            <span class="analysis-status">Simulated Analysis</span>
          </div>
          <div class="demo-analysis">
            <h5>Key Changes Identified:</h5>
            <ul>
              <li><strong>Regulatory Approach:</strong> The new data suggests enhanced digital submission requirements vs traditional paper-based processes</li>
              <li><strong>Timeline Impact:</strong> Potential acceleration of review processes with improved data quality standards</li>
              <li><strong>Compliance Requirements:</strong> Additional documentation and validation steps required for implementation</li>
              <li><strong>Risk Assessment:</strong> Medium impact on current operations with 6-month implementation timeline recommended</li>
            </ul>
            <p><em>Note: Configure AWS Bedrock API to get actual Claude analysis</em></p>
          </div>
        `;
        
        comparisonDisplay.className = 'llm-comparison-display analysis-active';
        document.getElementById('generateBtn').style.display = 'block';
      }
      
      // Reset button
      button.innerHTML = 'Generate AI Comparison with Claude';
      button.disabled = false;
      button.style.display = 'none';
    }
    
    // Function to handle opening impacted documents
    function openDocument(documentType) {
      const documentData = {
        'oncology-protocol': {
          title: 'Oncology Protocol Guidelines',
          description: 'Comprehensive guidelines for oncology drug development protocols including adaptive trial designs and biomarker integration.',
          lastUpdated: 'September 10, 2025',
          size: '2.4 MB'
        },
        'clinical-trial-design': {
          title: 'Clinical Trial Design Standards',
          description: 'Updated standards for clinical trial design incorporating flexible methodologies and interim analysis protocols.',
          lastUpdated: 'September 9, 2025',
          size: '1.8 MB'
        },
        'approval-pathways': {
          title: 'Accelerated Approval Pathways',
          description: 'Enhanced pathways for accelerated drug approval including breakthrough therapy designations and fast-track processes.',
          lastUpdated: 'September 8, 2025',
          size: '3.1 MB'
        },
        'evidence-requirements': {
          title: 'Real-World Evidence Requirements',
          description: 'New requirements for incorporating real-world evidence in regulatory submissions and post-market surveillance.',
          lastUpdated: 'September 7, 2025',
          size: '2.9 MB'
        }
      };

      const doc = documentData[documentType];
      if (doc) {
        // Create a notification showing document is being opened
        const notification = document.createElement('div');
        notification.innerHTML = `
          <div style="
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); 
            color: white; 
            padding: 15px 20px; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.5s ease;
            max-width: 350px;
          ">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
              <i class="fas fa-file-alt"></i>
              <strong>${doc.title}</strong>
            </div>
            <div style="font-size: 12px; opacity: 0.9; line-height: 1.4;">
              ${doc.description}
            </div>
            <div style="margin-top: 8px; font-size: 11px; opacity: 0.8;">
              Last Updated: ${doc.lastUpdated} | Size: ${doc.size}
            </div>
          </div>
        `;
        
        document.body.appendChild(notification);
        
        // Remove notification after 5 seconds
        setTimeout(() => {
          notification.remove();
        }, 5000);
      }
    }
    
    // Helper function to format Claude's response
    function formatClaudeResponse(response) {
      // Convert Claude's text response to formatted HTML
      let formatted = response
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Bold text
        .replace(/\*(.*?)\*/g, '<em>$1</em>') // Italic text
        .replace(/\n\n/g, '</p><p>') // Paragraphs
        .replace(/\n/g, '<br>'); // Line breaks
      
      // Wrap in paragraph tags
      formatted = '<p>' + formatted + '</p>';
      
      // Format lists
      formatted = formatted.replace(/^[-]\s*(.*$)/gm, '<li>$1</li>');
      formatted = formatted.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
      
      return formatted;
    }

    // Function to send chat message to AI
    function sendChatMessage() {
      const chatInput = document.getElementById('chatInput');
      const chatMessages = document.getElementById('chatMessages');
      const sendBtn = document.getElementById('sendChatBtn');
      
      const userMessage = chatInput.value.trim();
      if (!userMessage) return;
      
      // Add user message to chat
      const userMsgDiv = document.createElement('div');
      userMsgDiv.className = 'chat-message';
      userMsgDiv.innerHTML = `<div class="user-message">${userMessage}</div>`;
      chatMessages.appendChild(userMsgDiv);
      
      // Clear input and disable button
      chatInput.value = '';
      sendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Thinking...';
      sendBtn.disabled = true;
      
      // Scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Simulate AI response (in real implementation, this would call Claude API)
      setTimeout(() => {
        const aiResponses = [
          "I understand you want to modify the AI draft. Could you please specify which section you'd like me to focus on? For example, timeline requirements, compliance measures, or implementation strategies?",
          "Based on your request, I can help revise the regulatory comparison. Would you like me to emphasize specific areas like safety protocols, approval processes, or documentation requirements?",
          "I can assist with refining the AI draft. Please let me know if you want me to add more detail to any particular aspect of the regulatory analysis or suggest alternative approaches.",
          "Thank you for your feedback. I can help modify the draft to better address your specific regulatory concerns. Which particular regulation or requirement would you like me to elaborate on?",
          "I'm here to help improve the AI draft. Could you provide more context about what specific changes or enhancements you'd like to see in the regulatory comparison analysis?"
        ];
        
        const randomResponse = aiResponses[Math.floor(Math.random() * aiResponses.length)];
        
        const aiMsgDiv = document.createElement('div');
        aiMsgDiv.className = 'chat-message';
        aiMsgDiv.innerHTML = `<div class="ai-message">${randomResponse}</div>`;
        chatMessages.appendChild(aiMsgDiv);
        
        // Reset button
        sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send';
        sendBtn.disabled = false;
        
        // Scroll to bottom
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1500);
    }

    // Function to download comparison document
    function downloadComparison() {
      const currentTime = new Date().toLocaleString();
      const comparisonContent = document.getElementById('llmComparisonDisplay').innerText;
      const originalContent = document.getElementById('impactedDataDisplay').innerText;
      
      const documentContent = `
REGULATORY COMPARISON ANALYSIS REPORT
Generated: ${currentTime}
Platform: AURA - Regulatory Intelligence & Strategic Monitoring

==========================================
ORIGINAL DOCUMENT ANALYSIS
==========================================
${originalContent}

==========================================
AI DRAFT COMPARISON
==========================================
${comparisonContent}

==========================================
SUMMARY
==========================================
This analysis compares current regulatory requirements with proposed changes, 
highlighting key differences and implementation considerations for pharmaceutical 
companies. Generated using AWS Bedrock Claude AI technology.

Report generated by AURA Platform
 2025 All Rights Reserved
      `;
      
      // Create and download file
      const blob = new Blob([documentContent], { type: 'text/plain' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `AURA_Regulatory_Comparison_${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
      
      // Show success message
      const btn = document.getElementById('downloadComparisonBtn');
      const originalText = btn.innerHTML;
      btn.innerHTML = '<i class="fas fa-check"></i> Downloaded!';
      btn.style.background = '#22c55e';
      
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.background = '';
      }, 3000);
    }

    // Add Enter key support for chat input
    document.addEventListener('DOMContentLoaded', function() {
      const chatInput = document.getElementById('chatInput');
      if (chatInput) {
        chatInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendChatMessage();
          }
        });
      }
    });
  </script>
 
  <!-- Footer -->
  <footer>
    <p>Contact Us</p>
    <div class="footer-icons">
      <a href="#"><i class="fab fa-linkedin"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-facebook"></i></a>
      <a href="#"><i class="fab fa-github"></i></a>
    </div>
    <p>&copy; 2025 AURA. All Rights Reserved.</p>
  </footer>
</body>
</html>
